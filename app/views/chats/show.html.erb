<div class="container">
  <div class="row justify-content-between">
    <div class="chat-list">
      <table>
        <tr>
          <th><p>Your chat list</th>
        </tr>
        <% current_user.chats.each do |chat| %>
          <tr>
            <td <% if @chat.id == chat.id %> class="active" <% end %>>
              <a href="/chats/<%= chat.id %>"><p><%= chat.opposed_user(current_user).full_name %></p>
                <% if @chat.id != chat.id %>
                  <% if chat.messages.any? %>
                    <p class="last-msg"><%= chat.messages.last.body %></p>
                  <% end %>
                <% end %>
              </a>
            </td>
          </tr>
        <% end %>
      </table>
    </div>
    <div class="current-chat">
      <div class="d-flex pl-3">
        <img class="avatar" src="https://kitt.lewagon.com/placeholder/users/<%= @chat.opposed_user(current_user).lewagon_username %>">
        <h2><%= @chat.opposed_user(current_user).full_name %></h2>
      </div>
      <div class="messages" id="chatbox">
        <% @messages.each do |message| %>
          <% if @my_messages.include?(message) %>
            <div class="col-8 offset-4 d-flex justify-content-end">
              <div class="my-message-bubble my-msg" id="my-chat"><p><%= render 'messages/message', message: message %></p></div>
            </div>
          <% elsif @other_messages.include?(message) %>
            <div class="col-8 d-flex">
              <div class="other-message-bubble other-msg" id="other-chat"><p><%= render 'messages/message', message: message %></p></div>
            </div>
          <% end %>
        <% end %>
      </div>
      <div class="message-form">
        <%= render 'messages/form', chat: @chat, message: @message %>
      </div>
    </div>
  </div>
</div>

